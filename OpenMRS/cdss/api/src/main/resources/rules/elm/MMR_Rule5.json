{"library":{"annotation":[{"translatorOptions":"","type":"CqlToElmInfo"},{"message":"List-valued expression was demoted to a singleton.","errorType":"semantic","errorSeverity":"warning","type":"CqlToElmError"}],"identifier":{"id":"MMR5regular12months_4yrs_OneDoseOutOf12to15MonRecommendation","version":"1"},"schemaIdentifier":{"id":"urn:hl7-org:elm","version":"r1"},"usings":{"def":[{"localIdentifier":"System","uri":"urn:hl7-org:elm-types:r1"},{"localIdentifier":"FHIR","uri":"http://hl7.org/fhir","version":"4.0.1"},{"localIdentifier":"QUICK","uri":"http://hl7.org/fhir"}]},"includes":{"def":[{"localIdentifier":"Common","path":"MMR_Common_Library","version":"1"},{"localIdentifier":"FHIRHelpers","path":"FHIRHelpers","version":"4.0.1"}]},"parameters":{"def":[{"name":"Imm","accessLevel":"Public","parameterTypeSpecifier":{"type":"ListTypeSpecifier","elementType":{"name":"{http://hl7.org/fhir}Immunization","type":"NamedTypeSpecifier"}}}]},"contexts":{"def":[{"name":"Patient"}]},"statements":{"def":[{"name":"Patient","context":"Patient","expression":{"type":"SingletonFrom","operand":{"dataType":"{http://hl7.org/fhir}Patient","templateId":"http://hl7.org/fhir/StructureDefinition/Patient","type":"Retrieve"}}},{"name":"VaccineName","context":"Patient","accessLevel":"Public","expression":{"valueType":"{urn:hl7-org:elm-types:r1}String","value":"Measles, Mumps, and Rubella Virus Vaccine","type":"Literal"}},{"name":"CurrentAge","context":"Patient","accessLevel":"Public","expression":{"type":"And","operand":[{"type":"Greater","operand":[{"precision":"Month","type":"CalculateAge","operand":{"path":"birthDate.value","type":"Property","source":{"name":"Patient","type":"ExpressionRef"}}},{"valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"12","type":"Literal"}]},{"type":"Less","operand":[{"precision":"Year","type":"CalculateAge","operand":{"path":"birthDate.value","type":"Property","source":{"name":"Patient","type":"ExpressionRef"}}},{"valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"4","type":"Literal"}]}]}},{"name":"MMR_Vaccine_OneDose","context":"Patient","accessLevel":"Public","expression":{"type":"Equal","operand":[{"type":"Count","source":{"name":"FindValidVaccines","libraryName":"Common","type":"FunctionRef","operand":[{"name":"Imm","type":"ParameterRef"}]}},{"valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"1","type":"Literal"}]}},{"name":"MMRVaccineDate","context":"Patient","accessLevel":"Public","type":"FunctionDef","expression":{"type":"Query","source":[{"alias":"TemDate","expression":{"name":"Imm","type":"ParameterRef"}}],"relationship":[],"where":{"type":"In","operand":[{"name":"ToCode","libraryName":"FHIRHelpers","type":"FunctionRef","operand":[{"type":"SingletonFrom","operand":{"type":"As","operand":{"name":"FindValidCodes","libraryName":"Common","type":"FunctionRef","operand":[{"path":"coding","type":"Property","source":{"path":"vaccineCode","scope":"TemDate","type":"Property"}}]},"asTypeSpecifier":{"type":"ListTypeSpecifier","elementType":{"name":"{http://hl7.org/fhir}Coding","type":"NamedTypeSpecifier"}}}}]},{"name":"MMR_All_Valuesets","libraryName":"Common","type":"ExpressionRef"}]},"return":{"expression":{"type":"Tuple","element":[{"name":"Date","value":{"type":"Date","year":{"precision":"Year","type":"DateTimeComponentFrom","operand":{"asType":"{urn:hl7-org:elm-types:r1}DateTime","type":"As","operand":{"path":"value","type":"Property","source":{"path":"occurrence","scope":"TemDate","type":"Property"}}}},"month":{"precision":"Month","type":"DateTimeComponentFrom","operand":{"asType":"{urn:hl7-org:elm-types:r1}DateTime","type":"As","operand":{"path":"value","type":"Property","source":{"path":"occurrence","scope":"TemDate","type":"Property"}}}},"day":{"precision":"Day","type":"DateTimeComponentFrom","operand":{"asType":"{urn:hl7-org:elm-types:r1}DateTime","type":"As","operand":{"path":"value","type":"Property","source":{"path":"occurrence","scope":"TemDate","type":"Property"}}}}}}]}},"sort":{"by":[{"direction":"asc","path":"Date","type":"ByColumn"}]}},"operand":[{"name":"Immunizations","operandTypeSpecifier":{"type":"ListTypeSpecifier","elementType":{"name":"{http://hl7.org/fhir}Immunization","type":"NamedTypeSpecifier"}}}]},{"name":"PrevDoseDate","context":"Patient","accessLevel":"Public","expression":{"path":"Date","type":"Property","source":{"type":"Indexer","operand":[{"name":"MMRVaccineDate","type":"FunctionRef","operand":[{"name":"Imm","type":"ParameterRef"}]},{"valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"0","type":"Literal"}]}}},{"name":"AgeFirstFirstDoseMonths","context":"Patient","accessLevel":"Public","expression":{"precision":"Month","type":"DurationBetween","operand":[{"name":"ToDate","libraryName":"FHIRHelpers","type":"FunctionRef","operand":[{"path":"birthDate","type":"Property","source":{"name":"Patient","type":"ExpressionRef"}}]},{"name":"PrevDoseDate","type":"ExpressionRef"}]}},{"name":"AgeFirstMMRIn","context":"Patient","accessLevel":"Public","expression":{"type":"Or","operand":[{"type":"Less","operand":[{"name":"AgeFirstFirstDoseMonths","type":"ExpressionRef"},{"valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"12","type":"Literal"}]},{"type":"Greater","operand":[{"name":"AgeFirstFirstDoseMonths","type":"ExpressionRef"},{"valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"15","type":"Literal"}]}]}},{"name":"WeeksFromFirstDose","context":"Patient","accessLevel":"Public","expression":{"precision":"Week","type":"DifferenceBetween","operand":[{"path":"Date","type":"Property","source":{"type":"Indexer","operand":[{"name":"MMRVaccineDate","type":"FunctionRef","operand":[{"name":"Imm","type":"ParameterRef"}]},{"valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"0","type":"Literal"}]}},{"type":"Today"}]}},{"name":"InPopulation","context":"Patient","accessLevel":"Public","expression":{"type":"And","operand":[{"type":"And","operand":[{"type":"And","operand":[{"name":"MMR_Vaccine_OneDose","type":"ExpressionRef"},{"name":"AgeFirstMMRIn","type":"ExpressionRef"}]},{"name":"CurrentAge","type":"ExpressionRef"}]},{"type":"GreaterOrEqual","operand":[{"name":"WeeksFromFirstDose","type":"ExpressionRef"},{"valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"4","type":"Literal"}]}]}},{"name":"Recommendation1","context":"Patient","accessLevel":"Public","expression":{"type":"If","condition":{"name":"InPopulation","type":"ExpressionRef"},"then":{"valueType":"{urn:hl7-org:elm-types:r1}String","value":"Administer 2nd dose MMR","type":"Literal"},"else":{"asType":"{urn:hl7-org:elm-types:r1}String","type":"As","operand":{"type":"Null"}}}}]}},"path":"MMR5regular12months_4yrs_OneDoseOutOf12to15MonRecommendation\\MMR_Rule5_CQL20240730.cql"}